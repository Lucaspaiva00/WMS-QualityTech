generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model material {
  cod_material  Int    @id @default(autoincrement())
  pn_material   String
  lote          String
  data_validade String
  posicao       String
  quantidade    Int
  nf_entrada    String
  observacao    String

  // ✅ novo
  createdAt DateTime @default(now())

  operadorId Int?
  operador   operador? @relation(fields: [operadorId], references: [id])

  Saida saida[]
}

model saida {
  cod_saida     Int     @id @default(autoincrement())
  cod_material  Int
  pn_material   String
  lote          String
  data_validade String
  posicao       String
  nf_entrada    String
  observacao    String?
  quantidade    Int
  status        String  @default("pendente")

  // ✅ novo
  createdAt DateTime  @default(now())
  // ✅ opcional (mas recomendado)
  baixadoAt DateTime?

  operadorId Int?
  operador   operador? @relation(fields: [operadorId], references: [id])

  material material @relation(fields: [cod_material], references: [cod_material])
}

model posicao {
  cod_posicao Int    @id @default(autoincrement())
  posicao     String
}

model cliente {
  cod_cliente  Int        @id @default(autoincrement())
  nome_cliente String
  cnpj         String
  endereco     String
  telefone     String
  produtos     produtos[]
}

model produtos {
  cod_produto         Int     @id @default(autoincrement())
  nome_produto        String
  codigo              String
  peso_uni            String
  cliente_cod_cliente Int
  cliente             cliente @relation(fields: [cliente_cod_cliente], references: [cod_cliente])
}

model Minuta {
  id               Int      @id @default(autoincrement())
  cct              String
  nCT              String
  dhEmi            DateTime
  cMunIni          String
  cMunFim          String
  remetenteCNPJ    String
  destinatarioCNPJ String
  valorPrestacao   Float
  valorCarga       Float
  dhCriacao        DateTime @default(now())
}

model operador {
  id       Int      @id @default(autoincrement())
  nome     String
  usuario  String   @unique
  senha    String // já salvo criptografado
  criadoEm DateTime @default(now())

  materiais material[]
  saidas    saida[]
}
